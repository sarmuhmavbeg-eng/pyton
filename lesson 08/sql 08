create database class_10

Create table Person (personId int, firstName varchar(255), lastName varchar(255))
Create table Address (addressId int, personId int, city varchar(255), state varchar(255))
Truncate table Person
insert into Person (personId, lastName, firstName) values ('1', 'Wang', 'Allen')
insert into Person (personId, lastName, firstName) values ('2', 'Alice', 'Bob')
Truncate table Address
insert into Address (addressId, personId, city, state) values ('1', '2', 'New York City', 'New York')
insert into Address (addressId, personId, city, state) values ('2', '3', 'Leetcode', 'California')




select 
	p.firstname,
	p.lastName,
	a.city,
	a.state 
from Person p
left join Address a 
on p.personId = a.personId;



-------------

select * from Person p
select * from Address


select firstName,lastName,city,state from Address a
left join Address a on p.personId=a.personId

----------

Create table Employee (id int, name varchar(255), salary int, managerId int)
Truncate table Employee
insert into Employee (id, name, salary, managerId) values ('1', 'Joe', '70000', '3')
insert into Employee (id, name, salary, managerId) values ('2', 'Henry', '80000', '4')
insert into Employee (id, name, salary, managerId) values ('3', 'Sam', '60000', NULL)
insert into Employee (id, name, salary, managerId) values ('4', 'Max', '90000', NULL)


select	* from Employee

select e.name as Employee from Employee e	
JOIN Employee m ON e.managerId = m.id and e.salary > m.salary;
 
 



drop Table Person
Create table Person (id int, email varchar(255)) 
Truncate table Person 
insert into Person (id, email) values ('1', 'a@b.com') 
insert into Person (id, email) values ('2', 'c@d.com') 
insert into Person (id, email) values ('3', 'a@b.com')

select * from Person

SELECT email AS Email
FROM Person
GROUP BY email
HAVING COUNT(email) > 1;
