import pandas as pd

# CSV —Ñ–∞–π–ª–Ω–∏ —û“õ–∏—à
df = pd.read_csv("task/stackoverflow_qa.csv")

# 1. 2014 –π–∏–ª–≥–∞—á–∞ —è—Ä–∞—Ç–∏–ª–≥–∞–Ω —Å–∞–≤–æ–ª–ª–∞—Ä
df['–¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è'] = pd.to_datetime(df['–¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è'])
old_questions = df[df['–¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è'] < '2014-01-01']
print("üï∞Ô∏è –°–∞–≤–æ–ª–ª–∞—Ä (2014 –π–∏–ª–≥–∞—á–∞):")
print(old_questions.head(), "\n")

# 2. 50 –±–∞–ª–ª–¥–∞–Ω –∫—û–ø –æ–ª–≥–∞–Ω —Å–∞–≤–æ–ª–ª–∞—Ä
high_score = df[df['–æ—Ü–µ–Ω–∫–∞'] > 50]
print("‚≠ê 50 –±–∞–ª–ª–¥–∞–Ω —é“õ–æ—Ä–∏ –±–∞“≥–æ–ª–∞—Ä:")
print(high_score.head(), "\n")

# 3. 50 –¥–∞–Ω 100 –≥–∞—á–∞ –±—û–ª–≥–∞–Ω –±–∞“≥–æ–ª–∞—Ä
medium_score = df[(df['–æ—Ü–µ–Ω–∫–∞'] >= 50) & (df['–æ—Ü–µ–Ω–∫–∞'] <= 100)]
print("‚öñÔ∏è 50‚Äì100 –±–∞–ª–ª –æ—Ä–∞—Å–∏–¥–∞–≥–∏ –±–∞“≥–æ–ª–∞—Ä:")
print(medium_score.head(), "\n")

# 4. –°–∫–æ—Ç—Ç –ë–æ—Å—Ç–æ–Ω –∂–∞–≤–æ–± –±–µ—Ä–≥–∞–Ω —Å–∞–≤–æ–ª–ª–∞—Ä
scott_answers = df[df['–∏–º—è_–ø–æ–∑–∏—Ü–∏–∏'] == '–°–∫–æ—Ç—Ç –ë–æ—Å—Ç–æ–Ω']
print("üí¨ –°–∫–æ—Ç—Ç –ë–æ—Å—Ç–æ–Ω –∂–∞–≤–æ–± –±–µ—Ä–≥–∞–Ω —Å–∞–≤–æ–ª–ª–∞—Ä:")
print(scott_answers.head(), "\n")

# 5. 5 —Ç–∞ –±–µ–ª–≥–∏–ª–∞–Ω–≥–∞–Ω —Ñ–æ–π–¥–∞–ª–∞–Ω—É–≤—á–∏ –∂–∞–≤–æ–± –±–µ—Ä–≥–∞–Ω —Å–∞–≤–æ–ª–ª–∞—Ä
users = ['Unutbu', '–°–∫–æ—Ç—Ç –ë–æ—Å—Ç–æ–Ω', '–î–µ–º–∏—Ç—Ä–∏', '–ú–∞–π–∫ –ü–µ–Ω–Ω–∏–Ω–≥—Ç–æ–Ω', '–¥—É–≥']
user_questions = df[df['–∏–º—è_–ø–æ–∑–∏—Ü–∏–∏'].isin(users)]
print("üë• 5 —Ç–∞ —Ñ–æ–π–¥–∞–ª–∞–Ω—É–≤—á–∏ –∂–∞–≤–æ–± –±–µ—Ä–≥–∞–Ω —Å–∞–≤–æ–ª–ª–∞—Ä:")
print(user_questions.head(), "\n")

# 6. –ú–∞—Ä—Ç‚Äì–û–∫—Ç—è–±—Ä—å 2014, Unutbu –∂–∞–≤–æ–± –±–µ—Ä–≥–∞–Ω, –±–∞“≥–æ—Å–∏ <5
unutbu_2014 = df[
    (df['–¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è'].between('2014-03-01', '2014-10-31')) &
    (df['–∏–º—è_–ø–æ–∑–∏—Ü–∏–∏'] == 'Unutbu') &
    (df['–æ—Ü–µ–Ω–∫–∞'] < 5)
]
print("üìÖ 2014 –º–∞—Ä—Ç‚Äì–æ–∫—Ç—è–±—Ä—å, Unutbu –∂–∞–≤–æ–± –±–µ—Ä–≥–∞–Ω –≤–∞ –±–∞“≥–æ—Å–∏ <5:")
print(unutbu_2014, "\n")

# 7. 5‚Äì10 –±–∞–ª–ª —ë–∫–∏ 10 000 –¥–∞–Ω –æ—Ä—Ç–∏“õ –∫—û—Ä–∏—à
popular = df[((df['–æ—Ü–µ–Ω–∫–∞'] >= 5) & (df['–æ—Ü–µ–Ω–∫–∞'] <= 10)) | (df['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤'] > 10000)]
print("üî• 5‚Äì10 –±–∞–ª–ª —ë–∫–∏ 10K+ –∫—û—Ä–∏—à–≥–∞ —ç–≥–∞ —Å–∞–≤–æ–ª–ª–∞—Ä:")
print(popular.head(), "\n")

# 8. –°–∫–æ—Ç—Ç –ë–æ—Å—Ç–æ–Ω –∂–∞–≤–æ–± –±–µ—Ä–º–∞–≥–∞–Ω —Å–∞–≤–æ–ª–ª–∞—Ä
no_scott = df[df['–∏–º—è_–ø–æ–∑–∏—Ü–∏–∏'] != '–°–∫–æ—Ç—Ç –ë–æ—Å—Ç–æ–Ω']
print("üö´ –°–∫–æ—Ç—Ç –ë–æ—Å—Ç–æ–Ω –∂–∞–≤–æ–± –±–µ—Ä–º–∞–≥–∞–Ω —Å–∞–≤–æ–ª–ª–∞—Ä:")
print(no_scott.head(), "\n")







import pandas as pd

titanic_df = pd.read_csv("task/titanic.csv")

# 1. 1-–∫–ª–∞—Å—Å–¥–∞–≥–∏ 20‚Äì30 —ë—à–ª–∏ –∞—ë–ª–ª–∞—Ä
first_class_women = titanic_df[
    (titanic_df['Pclass'] == 1) &
    (titanic_df['–ü–æ–ª'].str.lower().isin(['–∂–µ–Ω—Å–∫–∏–π'])) &
    (titanic_df['–í–æ–∑—Ä–∞—Å—Ç'].between(20, 30))
]
print("üë©‚Äçü¶≥ 1-–∫–ª–∞—Å—Å–¥–∞–≥–∏ 20‚Äì30 —ë—à–ª–∏ –∞—ë–ª–ª–∞—Ä:")
print(first_class_women.head(), "\n")

# 2. 100 –¥–æ–ª–ª–∞—Ä–¥–∞–Ω –∫—û–ø —Ç—û–ª–∞–≥–∞–Ω–ª–∞—Ä
rich_passengers = titanic_df[titanic_df['–°—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ–µ–∑–¥–∞'] > 100]
print("üí∏ 100 –¥–æ–ª–ª–∞—Ä–¥–∞–Ω –∫—û–ø —Ç—û–ª–∞–≥–∞–Ω–ª–∞—Ä:")
print(rich_passengers.head(), "\n")

# 3. –Ø–∫–∫–∞ (–æ–∏–ª–∞ –∞—ä–∑–æ—Å–∏—Å–∏–∑) –≤–∞ —Ç–∏—Ä–∏–∫ “õ–æ–ª–≥–∞–Ω –π—û–ª–æ–≤—á–∏–ª–∞—Ä
solo_survivors = titanic_df[
    (titanic_df['–í—ã–∂–∏–ª'] == 1) &
    (titanic_df['SibSp'] == 0) &
    (titanic_df['Parch'] == 0)
]
print("üßç‚Äç‚ôÇÔ∏è –Ø–∫–∫–∞ —Ç–∏—Ä–∏–∫ “õ–æ–ª–≥–∞–Ω –π—û–ª–æ–≤—á–∏–ª–∞—Ä:")
print(solo_survivors.head(), "\n")

# 4. '–°' –ø–æ—Ä—Ç–¥–∞–Ω —á–∏“õ“õ–∞–Ω –≤–∞ 50 –¥–æ–ª–ª–∞—Ä–¥–∞–Ω –∫—û–ø —Ç—û–ª–∞–≥–∞–Ω–ª–∞—Ä
from_c_over50 = titanic_df[
    (titanic_df['–ü–æ—Å–∞–¥–∫–∞'] == 'C') &
    (titanic_df['–°—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ–µ–∑–¥–∞'] > 50)
]
print("üö¢ '–°' –ø–æ—Ä—Ç–¥–∞–Ω —á–∏“õ“õ–∞–Ω –≤–∞ 50 –¥–æ–ª–ª–∞—Ä–¥–∞–Ω –∫—û–ø —Ç—û–ª–∞–≥–∞–Ω–ª–∞—Ä:")
print(from_c_over50.head(), "\n")

# 5. –û–∏–ª–∞ –∞—ä–∑–æ–ª–∞—Ä–∏ –±–æ—Ä (SibSp>0 –≤–∞ Parch>0)
with_family = titanic_df[
    (titanic_df['SibSp'] > 0) & (titanic_df['Parch'] > 0)
]
print("üë®‚Äçüë©‚Äçüëß‚Äçüë¶ –û–∏–ª–∞ –∞—ä–∑–æ–ª–∞—Ä–∏ –±–æ—Ä –π—û–ª–æ–≤—á–∏–ª–∞—Ä:")
print(with_family.head(), "\n")

# 6. 15 —ë—à–¥–∞–Ω –∫–∏—á–∏–∫ –≤–∞ —Ç–∏—Ä–∏–∫ “õ–æ–ª–º–∞–≥–∞–Ω–ª–∞—Ä
kids_died = titanic_df[
    (titanic_df['–í–æ–∑—Ä–∞—Å—Ç'] <= 15) &
    (titanic_df['–í—ã–∂–∏–ª'] == 0)
]
print("üö∏ 15 —ë—à–¥–∞–Ω –∫–∏—á–∏–∫ –≤–∞ —Ç–∏—Ä–∏–∫ “õ–æ–ª–º–∞–≥–∞–Ω–ª–∞—Ä:")
print(kids_died.head(), "\n")

# 7. –ö–∞–±–∏–Ω–∞—Å–∏ –º–∞—ä–ª—É–º –≤–∞ –±–∏–ª–µ—Ç –Ω–∞—Ä—Ö–∏ >200
luxury = titanic_df[
    titanic_df['–ö–∞–±–∏–Ω–∞'].notna() & (titanic_df['–°—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ–µ–∑–¥–∞'] > 200)
]
print("üíé –ö–∞–±–∏–Ω–∞ –º–∞—ä–ª—É–º –≤–∞ –Ω–∞—Ä—Ö–∏ >200 –±—û–ª–≥–∞–Ω–ª–∞—Ä:")
print(luxury.head(), "\n")

# 8. –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–∞“õ (–Ω–µ—á—ë—Ç–Ω—ã–π)
odd_id = titanic_df[titanic_df['PassengerId'] % 2 == 1]
print("üî¢ –¢–∞“õ ID–ª–∏ –π—û–ª–æ–≤—á–∏–ª–∞—Ä:")
print(odd_id.head(), "\n")

# 9. –£–Ω–∏–∫–∞–ª –±–∏–ª–µ—Ç —Ä–∞“õ–∞–º–∏–≥–∞ —ç–≥–∞ –π—û–ª–æ–≤—á–∏–ª–∞—Ä
unique_tickets = titanic_df.drop_duplicates(subset=['–ë–∏–ª–µ—Ç'])
print("üé´ –£–Ω–∏–∫–∞–ª –±–∏–ª–µ—Ç —Ä–∞“õ–∞–º–ª–∏ –π—û–ª–æ–≤—á–∏–ª–∞—Ä:")
print(unique_tickets.head(), "\n")

# 10. –ò—Å–º–∏–¥–∞ ‚Äú–º–∏—Å—Å‚Äù —Å—û–∑–∏ –±–æ—Ä –≤–∞ 1-–∫–ª–∞—Å—Å–¥–∞–≥–∏ –π—û–ª–æ–≤—á–∏–ª–∞—Ä
miss_first_class = titanic_df[
    (titanic_df['–ò–º—è'].str.contains("–º–∏—Å—Å", case=False, na=False)) &
    (titanic_df['Pclass'] == 1)
]
print("üë±‚Äç‚ôÄÔ∏è –ò—Å–º–∏–¥–∞ '–º–∏—Å—Å' –±–æ—Ä –≤–∞ 1-–∫–ª–∞—Å—Å–¥–∞–≥–∏ –π—û–ª–æ–≤—á–∏–ª–∞—Ä:")
print(miss_first_class.head(), "\n")




