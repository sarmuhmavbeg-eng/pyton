use stat02_Lesson07


create table family (id int, name varchar(25),parentid int)
insert into family values (1, 'Grandfather',Null), (2,'Father',1),
(3, 'Uncle',1), (4,'Me',2),(5,'My son',4),(6,'Cousin',3),(7,'Cousin son',6)

select child.name as child, parent.name as parent from family as child
left join family as parent
on child.parentid = parent.id

------- bobosi va otasini topish

select child.name as child, parent.name as parent, grandparent. name as grandparent from family as child
left join family as parent
on child.parentid = parent.id
left join family as grandparent
on parent.parentid = grandparent.id

-------

create table letters (letter varchar(50))

insert into letters values ('A'),('B'),('C'),('D'),('E'),('F')

select * from letters as l1
join letters as l2
on l1.Letter <> l2.letter


select l1.letter,max(l2.letter) as perv_letter from letters as l1
left join letters as l2
on l1.letter > l2.letter
group by l1.letter

-----
create table sales (year int, sales int)

insert into sales values (2000, 10000), (2001,25000),(2002,24000),(2003,26000)

select * from sales

select s1.year,s1.sales,sum(s2.sales) as runing_total from sales as s1
left join Sales as s2
on s1.year > = s2.year
group by s1.year,s1.sales
order by s1.year

select * from ProductSales


